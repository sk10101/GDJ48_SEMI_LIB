<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gdj.lib.dao.MemberDAO">
	

	<select id="memberUpdateDetailMy" resultType="com.gdj.lib.dto.MemberDTO" parameterType="String">
		Select mb_id, mb_pw, name, phone, email FROM member WHERE mb_id = #{mb_id}
	</select>
	
	<select id="memberUpdateListMy" resultType="com.gdj.lib.dto.MemberDTO">
		SELECT mb_id, mb_pw, name, phone, email FROM member
		
	</select>

	<select id="memberList" resultType="com.gdj.lib.dto.MemberDTO">
		SELECT mb_id, name, mb_status FROM member where mb_class = '일반회원'

	</select>
	
	<select id="detail" parameterType="String" resultType="com.gdj.lib.dto.MemberDTO">
		SELECT * FROM member WHERE mb_id = #{mb_id}	
	</select>
	
	<select id="adminList" resultType="com.gdj.lib.dto.MemberDTO">
		SELECT mb_id, name, phone FROM member where mb_class = '관리자'
	</select>
	
	<update id="update" parameterType="hashmap">
		UPDATE member SET mb_class = #{mb_class}
		WHERE mb_id = #{mb_id}
	</update>
	
	<select id="blackList" resultType="com.gdj.lib.dto.MemberDTO">
		SELECT black_id,mb_id, admin_start, black_start, admin_end, black_end FROM blacklist
	</select>
	
	<select id="blackDetail" resultType="com.gdj.lib.dto.MemberDTO">
      SELECT *FROM blackList b ,member m WHERE b.mb_id = m.mb_id and black_id= #{param1}
	</select>
	
	<select id="idget" resultType="String">
		SELECT mb_id FROM member WHERE mb_id = #{mb_id}
	</select>
	
	<insert id="blackAdd" parameterType="com.gdj.lib.dto.MemberDTO">
		INSERT INTO blacklist (mb_id,admin_start, black_reason) 
			VALUES(#{mb_id},#{admin_start},#{black_reason})
	</insert>
	
	<select id="penaltyList" resultType="com.gdj.lib.dto.MemberDTO">
		SELECT penalty_id,mb_id,category_id,penalty_start,penalty_end,cancel  FROM penalty
	</select>
	
	<select id="penaltyDetail" resultType="com.gdj.lib.dto.MemberDTO">
      <!-- SELECT *FROM penalty WHERE penalty_id= #{param1} -->
      SELECT *FROM penalty p ,member m WHERE p.mb_id = m.mb_id and penalty_id= #{param1}
   </select>
   
	
	  <update id="penaltyUpdate" parameterType="hashmap">
      UPDATE penalty SET cancel  = #{cancel} 
      , admin_cancel = #{admin_cancel}
      ,penalty_end = now()
      WHERE penalty_id = #{penalty_id}
   </update>
   
   
    <update id="blackUpdate" parameterType="hashmap">
      UPDATE blacklist SET black_cancel  = #{black_cancel} 
      , admin_end = #{admin_end}
      , end_reason = #{end_reason}
      ,black_end = now()
      WHERE black_id = #{black_id}
   </update>
   
   
   
	
	
	
	
	
	
	
	
	<!-- ============================================== -->
	
	<insert id="memberjoin" parameterType="hashmap">
		INSERT INTO member(mb_id,mb_pw,name,phone,email,mb_class)
		VALUES(#{id},#{pw},#{name},#{phone},#{email},'일반회원')
	</insert>
		
	<select id="memberoverlay" parameterType="String" resultType="String">
		SELECT * FROM member WHERE mb_id = #{chkId}
			
			
	</select>
	
	<select id="memberoverlays" parameterType="String" resultType="String">
	SELECT * FROM member WHERE email = #{chkEmail}
			
			
	</select>
	
	<select id="idFind" resultType="String" parameterType="String">
	SELECT mb_id FROM member WHERE email = #{email}
	</select>
	
	<select id="pwFind" resultType="String">
	SELECT mb_pw FROM member WHERE mb_id = #{param1} AND email = #{param2}
	</select>
	
	<select id="login" resultType="String">
	SELECT mb_id FROM member WHERE mb_id = #{param1} AND mb_pw= #{param2};

	</select>
	
	
	
	
	
	
	
	<!-- ============================================== -->
	
	<select id="brwList" parameterType="String" resultType="com.gdj.lib.dto.BrwBookDTO">
		SELECT brw_id, b.b_id, b.b_title, brw_date, return_date, return_finish, brw_status
		FROM borrow brw, book b 
		WHERE brw.b_id = b.b_id AND mb_id=#{mb_id}
	</select>
	
	
	
	
	
	
	
	
	
	
	
	
</mapper>


